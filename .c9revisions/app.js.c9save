{"ts":1367552795910,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"// This is a sample application which you can use as a starting point for your\n// project. The only parts you should *need* to change are indicated with `TODO`\n// below. However, you are welcome to change more if you wish.\n\n////////////////////////////////////////////////////////////////////////////////\n\nvar USER_OR_GROUP_NAME = ''; // TODO: Insert GitHub username or group name.\n\n////////////////////////////////////////////////////////////////////////////////\n\nif (! USER_OR_GROUP_NAME) { \n  throw new Error(\n    'You must set your GitHub username or group name in the app.js file'); \n}\n\n// Import some utility functions.\nvar utils = require('./utils');\n\n// Create a new web application.\nvar app = utils.initializeWebApp();\n\n// Connect to your database.\nvar db = utils.connectToDatabase(USER_OR_GROUP_NAME);\n\n// TODO: Start defining your resource handlers. You may just need to modify the\n// examples below, or you may need to add additional handlers by copying,\n// pasting, and modifying these examples.\n\n////////////////////////////////////////////////////////////////////////////////\n// Example of handling PUT to create or update a resource. /////////////////////\n// Here we create or update an item using the ID specified in the URI. /////////\n////////////////////////////////////////////////////////////////////////////////\napp.put('/parties/:id',      // TODO: change to suit your URI design.\n  function(req, res) {\n  \n    // Get the item ID from the URI.\n    var item_id = req.params.id;\n\n    // Get the item info that was PUT from the input form.\n    // See the form in `views/list-parties.ejs`.\n    var item = req.body.item;\n    \n    item.type = 'party'; // TODO: change to the type of item you want\n\n    // Save the new item to the database, specifying the ID.\n    db.save(item_id, item, function(err) {\n\n      // If there was a database error, return an error status.\n      if (err) { res.send(err, 500); } \n      \n      // Otherwise, redirect back to the URI from which the form was submitted.\n      else { res.redirect('back' ); }\n    });\n  }\n);\n\n////////////////////////////////////////////////////////////////////////////////\n// Example of handling GET of a \"collection\" resource. /////////////////////////\n// Here we list all items of type `party`. /////////////////////////////////////\n////////////////////////////////////////////////////////////////////////////////\napp.get('/parties/',         // TODO: change to suit your URI design. \n  function(req, res) {\n\n    var item_type = 'party'; // TODO: change to the type of item you want.\n\n    // Get all items of the specified type from the database.\n    db.getAll(item_type, function(err, items) {\n\n      // If there was a database error, return an error status.\n      if (err) { res.send(err, 500); } \n\n      // Otherwise, use the returned data to render an HTML page.\n      else {\n        res.render(\n          'list-parties',   // TODO: change to the name of your HTML template.\n          { items: items }\n        );\n      }\n    });\n  }\n);\n\n////////////////////////////////////////////////////////////////////////////////\n// Example of handling POST to create a resource. //////////////////////////////\n// Here we create an item and allow the ID to be created automatically. ////////\n////////////////////////////////////////////////////////////////////////////////\napp.post('/candidates/', // TODO: change to suit your URI design.\n  function(req, res) {\n  \n    // Get the item info that was POSTed from the input form.\n    // See the form in `views/one-party.ejs`.\n    var item = req.body.item;\n\n    item.type = 'candidate'; // TODO: change to the type of item you want\n\n    // Save the new item to the database. (No ID specified, it will be created.)\n    db.save(item, function(err) {\n\n      // If there was a database error, return an error status.\n      if (err) { res.send(err, 500); } \n      \n      // Otherwise, redirect back to the URI from which the form was submitted.\n      else { res.redirect('back' ); }\n    });\n  }\n);\n\n////////////////////////////////////////////////////////////////////////////////\n// Another example of handling PUT to update a resource. ///////////////////////\n// Here we update an item using the ID specified in the URI. ///////////////////\n////////////////////////////////////////////////////////////////////////////////\napp.put('/candidates/:id', // TODO: change to suit your URI design.\n  function(req, res) {\n  \n    // Get the item ID from the URI.\n    var item_id = req.params.id;\n\n    // Get the item info that was PUT from the input form.\n    // See the form in `views/one-candidate.ejs`.\n    var item = req.body.item;\n\n    item.type = 'candidate'; // TODO: change to the type of item you want\n\n    // Save the new item to the database, specifying the ID.\n    db.save(item_id, item, function(err) {\n\n      // If there was a database error, return an error status.\n      if (err) { res.send(err, 500); } \n      \n      // Otherwise, redirect back to the URI from which the form was submitted.\n      else { res.redirect('back' ); }\n    });\n  }\n);\n\n////////////////////////////////////////////////////////////////////////////////\n// Another example of handling GET of a \"collection\" resource. /////////////////\n// This time we support filtering the list by some criteria (i.e. searching). //\n////////////////////////////////////////////////////////////////////////////////\napp.get('/candidates/',          // TODO: change to suit your URI design. \n  function(req, res) {\n\n    var item_type = 'candidate'; // TODO: change to the type of item you want.\n\n    // Get items of the specified type that match the query.\n    db.getSome(item_type, req.query, function(err, items) {\n\n      // If there was a database error, return an error status.\n      if (err) { res.send(err, 500); } \n\n      // Otherwise, use the returned data to render an HTML page.\n      else {\n        res.render(\n          'list-candidates', // TODO: change to the name of your HTML template.\n          { items: items }\n        );\n      }\n    });\n  }\n);\n\n////////////////////////////////////////////////////////////////////////////////\n// An example of handling GET of a \"single\" resource. //////////////////////////\n// This handler is more complicated, because we want to show not only the //////\n// item requested, but also links to a set of related items. ///////////////////\n////////////////////////////////////////////////////////////////////////////////\napp.get('/parties/:id',      // TODO: change to suit your URI design.\n  function(req, res) {\n\n    var item_type = 'party'; // TODO: change to the type of item you want.\n\n    // Get the item ID from the URI.\n    var item_id = req.params.id;\n  \n    // Get one item of the specified type, identified by the item ID.\n    db.getOne(item_type, item_id, function(err, item) {\n        \n      // If there was a database error, return an error status.\n      if (err) {\n        if (err.error == 'not_found') { res.send(404); }\n        else { res.send(err, 500); }\n      } \n\n      // Otherwise, get the related items associated with this item.\n      else {\n        \n        var related_type = 'candidate'; // TODO: change to type of related item.\n\n        // Set our query to find the items related to the requested item.\n        req.query.party = item_id; // TODO: change `party` to reflect the\n                                   // relation between the item fetched above\n                                   // and the related items to be fetched below.\n\n        // Get items of the specified type that match the query.\n        db.getSome(related_type, req.query, function(err, items) {\n\n          // If there was a database error, return an error status.\n          if (err) { res.send(err, 500); } \n\n          // Otherwise, use the returned data to render an HTML page.\n          else {\n            res.render(\n            'one-party', // TODO: change to the name of your HTML template.\n              { item: item, related_items: items }\n            );\n          }\n        });\n      }\n    });\n  }\n);\n\n////////////////////////////////////////////////////////////////////////////////\n// An example of handling GET of a \"single\" resource. //////////////////////////\n// This handler is also complicated, because we want to show not only the //////\n// item requested, but also a list of potential related items, so that users ///\n// can select from a list when updating the item. //////////////////////////////\n////////////////////////////////////////////////////////////////////////////////\napp.get('/candidates/:id',       // TODO: change to suit your URI design.\n  function(req, res) {\n\n    var item_type = 'candidate'; // TODO: change to the type of item you want.\n\n    // Get the item ID from the URI.\n    var item_id = req.params.id;\n  \n    // Get one item of the specified type, identified by the item ID.\n    db.getOne(item_type, item_id, function(err, item) {\n        \n      // If there was a database error, return an error status.\n      if (err) {\n        if (err.error == 'not_found') { res.send(404); }\n        else { res.send(err, 500); }\n      } \n\n      // Otherwise, get the items potentially related to this item.\n      else {\n        \n        var related_type = 'party'; // TODO: change to type of related item.\n\n        // Get all items of the specified related type.\n        db.getAll(related_type, function(err, items) {\n\n          // If there was a database error, return an error status.\n          if (err) { res.send(err, 500); } \n\n          // Otherwise, use the returned data to render an HTML page.\n          else {\n            res.render(\n              'one-candidate', // TODO: change to name of your HTML template.\n              { item: item, related_items: items }\n            );\n          }\n        });\n      }\n    });\n  }\n);\n\n\n// Handle GET of the \"index\" resource.\napp.get('/', function(req, res) { res.render('index'); });\n\n// Start listening for incoming HTTP connections.\napp.listen(process.env.PORT);\n"]],"start1":0,"start2":0,"length1":0,"length2":9961}]],"length":9961}
{"contributors":[],"silentsave":false,"ts":1367552860661,"patch":[[{"diffs":[[0,"NAME = '"],[1,"kennedyc"],[0,"'; // TO"]],"start1":324,"start2":324,"length1":16,"length2":24}]],"length":9969,"saved":false}
{"ts":1367553810434,"patch":[[{"diffs":[[0,"/\napp.put('/"],[-1,"partie"],[1,"cd"],[0,"s/:id',     "]],"start1":1340,"start2":1340,"length1":30,"length2":26},{"diffs":[[0,"p.get('/"],[-1,"partie"],[1,"cd"],[0,"s/',    "]],"start1":2395,"start2":2395,"length1":22,"length2":18},{"diffs":[[0,"ar item_type = '"],[-1,"party"],[1,"cd"],[0,"'; // TODO: chan"]],"start1":2489,"start2":2489,"length1":37,"length2":34},{"diffs":[[0,"  'list-"],[-1,"partie"],[1,"cd"],[0,"s',   //"]],"start1":2880,"start2":2880,"length1":22,"length2":18},{"diffs":[[0,"\napp.post('/"],[-1,"candidate"],[1,"track"],[0,"s/', // TODO"]],"start1":3332,"start2":3332,"length1":33,"length2":29},{"diffs":[[0,"tem.type = '"],[-1,"candidate"],[1,"track"],[0,"'; // TODO: "]],"start1":3565,"start2":3565,"length1":33,"length2":29},{"diffs":[[0,"/\napp.put('/"],[-1,"candidate"],[1,"track"],[0,"s/:id', // T"]],"start1":4314,"start2":4314,"length1":33,"length2":29},{"diffs":[[0,"tem.type = '"],[-1,"candidate"],[1,"track"],[0,"'; // TODO: "]],"start1":4622,"start2":4622,"length1":33,"length2":29},{"diffs":[[0,"p.get('/"],[-1,"candidate"],[1,"track"],[0,"s/',    "]],"start1":5364,"start2":5364,"length1":25,"length2":21},{"diffs":[[0,"tem_type = '"],[-1,"candidate"],[1,"track"],[0,"'; // TODO: "]],"start1":5466,"start2":5466,"length1":33,"length2":29},{"diffs":[[0,"  'list-"],[-1,"candidate"],[1,"track"],[0,"s', // T"]],"start1":5867,"start2":5867,"length1":25,"length2":21},{"diffs":[[0,"p.get('/"],[-1,"partie"],[1,"cd"],[0,"s/:id', "]],"start1":6404,"start2":6404,"length1":22,"length2":18},{"diffs":[[0,"ar item_type = '"],[-1,"party"],[1,"cd"],[0,"'; // TODO: chan"]],"start1":6497,"start2":6497,"length1":37,"length2":34},{"diffs":[[0,"ted_type = '"],[-1,"candidate"],[1,"track"],[0,"'; // TODO: "]],"start1":7065,"start2":7065,"length1":33,"length2":29},{"diffs":[[0,"q.query."],[-1,"party"],[1,"cd"],[0," = item_"]],"start1":7211,"start2":7211,"length1":21,"length2":18},{"diffs":[[0,"   'one-"],[-1,"party"],[1,"cd"],[0,"', // TO"]],"start1":7798,"start2":7798,"length1":21,"length2":18},{"diffs":[[0,"p.get('/"],[-1,"candidate"],[1,"track"],[0,"s/:id', "]],"start1":8464,"start2":8464,"length1":25,"length2":21},{"diffs":[[0,"type = '"],[-1,"candidate"],[1,"track"],[0,"'; // TO"]],"start1":8569,"start2":8569,"length1":25,"length2":21},{"diffs":[[0,"related_type = '"],[-1,"party"],[1,"cd"],[0,"'; // TODO: chan"]],"start1":9127,"start2":9127,"length1":37,"length2":34},{"diffs":[[0,"   'one-"],[-1,"candidate"],[1,"track"],[0,"', // TO"]],"start1":9537,"start2":9537,"length1":25,"length2":21}]],"length":9894,"saved":false}
{"ts":1367554323491,"patch":[[{"diffs":[[0,"type = '"],[-1,"party"],[1,"cd"],[0,"'; // TO"]],"start1":1657,"start2":1657,"length1":21,"length2":18}]],"length":9891,"saved":false}
{"ts":1367554829605,"patch":[[{"diffs":[[0,"k' ); }\n    });\n"],[1,"    console.log(\"Calculating grobble vectors…\");\n"],[0,"  }\n);\n\n////////"]],"start1":2042,"start2":2042,"length1":32,"length2":81}]],"length":9940,"saved":false}
{"ts":1367554869142,"patch":[[{"diffs":[[0,"});\n"],[-1,"    console.log(\"Calculating grobble vectors…\");\n"],[0,"  }\n"]],"start1":2054,"start2":2054,"length1":57,"length2":8}]],"length":9891,"saved":false}
